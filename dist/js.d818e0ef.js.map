{"version":3,"sources":["src/js/index.js"],"names":["body","document","imageLoader","querySelector","cropBox","imageWrapper","shiftCoefficient","x","y","addEventListener","inputFiles","files","length","inputFile","img","createElement","className","appendChild","reader","FileReader","event","src","target","result","initCropFunc","alert","error","code","readAsDataURL","e","startMoveCropBox","stopMoveCropBox","cropBoxControl","startChangeCropBox","stopChangeCropBox","cropButton","crop","cropBoxStyles","getBoundingClientRect","pageX","left","pageY","top","moveCropBox","style","removeEventListener","stopPropagation","changeCropBox","width","height","myCanvas","imageWrapperStyles","setAttribute","ctx","getContext","drawImage"],"mappings":"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","file":"js.d818e0ef.js","sourceRoot":"..","sourcesContent":["const body = document.body;\r\nconst imageLoader = document.querySelector('.image-loader');\r\nconst cropBox = document.querySelector('.crop-box');\r\nconst imageWrapper = document.querySelector('.image_wrapper');\r\nlet shiftCoefficient = {\r\n    x: 0,\r\n    y: 0\r\n};\r\n\r\nimageLoader.addEventListener('change', () => {\r\n    try {\r\n        const inputFiles = imageLoader.files;\r\n        if (!inputFiles || inputFiles.length === 0) {\r\n            return;\r\n        }\r\n\r\n        const inputFile = inputFiles[0];\r\n        const img = document.createElement('img');\r\n        img.className = 'preview';\r\n        imageWrapper.appendChild(img);\r\n\r\n        const reader = new FileReader();\r\n        reader.addEventListener('load', (event) => {\r\n            img.src = event.target.result;\r\n            initCropFunc();\r\n        });\r\n        reader.addEventListener('error', (event) => {\r\n            alert('ERROR: ' + event.target.error.code);\r\n        });\r\n        reader.readAsDataURL(inputFile);\r\n    } catch(e) {\r\n        alert(`Something went wrong ${e}`);\r\n    }\r\n});\r\n\r\nfunction initCropFunc() {\r\n    cropBox.addEventListener('mousedown', startMoveCropBox);\r\n    cropBox.addEventListener('mouseup', stopMoveCropBox);\r\n\r\n    const cropBoxControl = document.querySelector('.crop-box-control');\r\n    cropBoxControl.addEventListener('mousedown', startChangeCropBox);\r\n    cropBoxControl.addEventListener('mouseup', stopChangeCropBox);\r\n\r\n    const cropButton = document.querySelector('.crop-btn');\r\n    cropButton.addEventListener('click', crop);\r\n}\r\n\r\nfunction startMoveCropBox(e) {\r\n    const cropBoxStyles = cropBox.getBoundingClientRect();\r\n    shiftCoefficient = {\r\n        x: e.pageX - cropBoxStyles.left,\r\n        y: e.pageY - cropBoxStyles.top\r\n    }\r\n    body.addEventListener('mousemove', moveCropBox);\r\n    body.addEventListener('mouseup', stopMoveCropBox);\r\n}\r\n\r\nfunction moveCropBox(e) {\r\n    const cropBoxStyles = cropBox.getBoundingClientRect();\r\n\r\n    cropBox.style.left = e.pageX - shiftCoefficient.x + 'px';\r\n    cropBox.style.top = e.pageY - shiftCoefficient.y + 'px';\r\n}\r\n\r\nfunction stopMoveCropBox() {\r\n    body.removeEventListener('mousemove', moveCropBox);\r\n}\r\n\r\n\r\nfunction startChangeCropBox(e) {\r\n    e.stopPropagation();\r\n    body.addEventListener('mousemove', changeCropBox);\r\n    body.addEventListener('mouseup', stopChangeCropBox);\r\n}\r\n\r\nfunction changeCropBox(e) {\r\n    const cropBoxStyles = cropBox.getBoundingClientRect();\r\n\r\n    cropBox.style.width = e.pageX - cropBoxStyles.left + 'px';\r\n    cropBox.style.height = e.pageY - cropBoxStyles.top + 'px';\r\n}\r\n\r\nfunction stopChangeCropBox() {\r\n    body.removeEventListener('mousemove', changeCropBox);\r\n}\r\n\r\nfunction crop() {\r\n    const myCanvas = document.querySelector('.my-canvas');\r\n    const cropBoxStyles = cropBox.getBoundingClientRect();\r\n    const imageWrapperStyles = imageWrapper.getBoundingClientRect();\r\n\r\n    myCanvas.setAttribute('width', cropBoxStyles.width + 'px');\r\n    myCanvas.setAttribute('height', cropBoxStyles.height + 'px');\r\n\r\n    const ctx = myCanvas.getContext('2d');\r\n    const img = document.querySelector('.preview');\r\n    ctx.drawImage(img, -(cropBoxStyles.left - imageWrapperStyles.left), -(cropBoxStyles.top - imageWrapperStyles.top));\r\n}"]}