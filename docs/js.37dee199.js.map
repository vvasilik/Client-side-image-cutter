{"version":3,"sources":["src/js/index.js"],"names":["body","document","imageLoader","querySelector","cropBox","imageWrapper","shiftCoefficient","x","y","initCropFunc","addEventListener","startMoveCropBox","stopMoveCropBox","cropBoxControl","startChangeCropBox","stopChangeCropBox","crop","e","cropBoxStyles","getBoundingClientRect","pageX","left","pageY","top","moveCropBox","style","removeEventListener","stopPropagation","changeCropBox","width","height","myCanvas","imageWrapperStyles","setAttribute","ctx","getContext","img","drawImage","inputFiles","files","length","inputFile","createElement","className","appendChild","reader","FileReader","event","src","target","result","alert","error","code","readAsDataURL"],"mappings":";AAAA,IAAMA,EAAOC,SAASD,KAChBE,EAAcD,SAASE,cAAc,iBACrCC,EAAUH,SAASE,cAAc,aACjCE,EAAeJ,SAASE,cAAc,kBACxCG,EAAmB,CACnBC,EAAG,EACHC,EAAG,GA6BP,SAASC,IACLL,EAAQM,iBAAiB,YAAaC,GACtCP,EAAQM,iBAAiB,UAAWE,GAE9BC,IAAAA,EAAiBZ,SAASE,cAAc,qBAC9CU,EAAeH,iBAAiB,YAAaI,GAC7CD,EAAeH,iBAAiB,UAAWK,GAExBd,SAASE,cAAc,aAC/BO,iBAAiB,QAASM,GAGzC,SAASL,EAAiBM,GAChBC,IAAAA,EAAgBd,EAAQe,wBAC9Bb,EAAmB,CACfC,EAAGU,EAAEG,MAAQF,EAAcG,KAC3Bb,EAAGS,EAAEK,MAAQJ,EAAcK,KAE/BvB,EAAKU,iBAAiB,YAAac,GACnCxB,EAAKU,iBAAiB,UAAWE,GAGrC,SAASY,EAAYP,GACKb,EAAQe,wBAE9Bf,EAAQqB,MAAMJ,KAAOJ,EAAEG,MAAQd,EAAiBC,EAAI,KACpDH,EAAQqB,MAAMF,IAAMN,EAAEK,MAAQhB,EAAiBE,EAAI,KAGvD,SAASI,IACLZ,EAAK0B,oBAAoB,YAAaF,GAI1C,SAASV,EAAmBG,GACxBA,EAAEU,kBACF3B,EAAKU,iBAAiB,YAAakB,GACnC5B,EAAKU,iBAAiB,UAAWK,GAGrC,SAASa,EAAcX,GACbC,IAAAA,EAAgBd,EAAQe,wBAE9Bf,EAAQqB,MAAMI,MAAQZ,EAAEG,MAAQF,EAAcG,KAAO,KACrDjB,EAAQqB,MAAMK,OAASb,EAAEK,MAAQJ,EAAcK,IAAM,KAGzD,SAASR,IACLf,EAAK0B,oBAAoB,YAAaE,GAG1C,SAASZ,IACCe,IAAAA,EAAW9B,SAASE,cAAc,cAClCe,EAAgBd,EAAQe,wBACxBa,EAAqB3B,EAAac,wBAExCY,EAASE,aAAa,QAASf,EAAcW,MAAQ,MACrDE,EAASE,aAAa,SAAUf,EAAcY,OAAS,MAEjDI,IAAAA,EAAMH,EAASI,WAAW,MAC1BC,EAAMnC,SAASE,cAAc,YACnC+B,EAAIG,UAAUD,IAAOlB,EAAcG,KAAOW,EAAmBX,QAASH,EAAcK,IAAMS,EAAmBT,MAvFjHrB,EAAYQ,iBAAiB,SAAU,WAC/B,IACM4B,IAAAA,EAAapC,EAAYqC,MAC3B,IAACD,GAAoC,IAAtBA,EAAWE,OAC1B,OAGEC,IAAAA,EAAYH,EAAW,GACvBF,EAAMnC,SAASyC,cAAc,OACnCN,EAAIO,UAAY,UAChBtC,EAAauC,YAAYR,GAEnBS,IAAAA,EAAS,IAAIC,WACnBD,EAAOnC,iBAAiB,OAAQ,SAACqC,GAC7BX,EAAIY,IAAMD,EAAME,OAAOC,OACvBzC,MAEJoC,EAAOnC,iBAAiB,QAAS,SAACqC,GAC9BI,MAAM,UAAYJ,EAAME,OAAOG,MAAMC,QAEzCR,EAAOS,cAAcb,GACvB,MAAMxB,GACJkC,MAA8BlC,wBAAAA,OAAAA","file":"js.37dee199.js","sourceRoot":"..","sourcesContent":["const body = document.body;\r\nconst imageLoader = document.querySelector('.image-loader');\r\nconst cropBox = document.querySelector('.crop-box');\r\nconst imageWrapper = document.querySelector('.image_wrapper');\r\nlet shiftCoefficient = {\r\n    x: 0,\r\n    y: 0\r\n};\r\n\r\nimageLoader.addEventListener('change', () => {\r\n    try {\r\n        const inputFiles = imageLoader.files;\r\n        if (!inputFiles || inputFiles.length === 0) {\r\n            return;\r\n        }\r\n\r\n        const inputFile = inputFiles[0];\r\n        const img = document.createElement('img');\r\n        img.className = 'preview';\r\n        imageWrapper.appendChild(img);\r\n\r\n        const reader = new FileReader();\r\n        reader.addEventListener('load', (event) => {\r\n            img.src = event.target.result;\r\n            initCropFunc();\r\n        });\r\n        reader.addEventListener('error', (event) => {\r\n            alert('ERROR: ' + event.target.error.code);\r\n        });\r\n        reader.readAsDataURL(inputFile);\r\n    } catch(e) {\r\n        alert(`Something went wrong ${e}`);\r\n    }\r\n});\r\n\r\nfunction initCropFunc() {\r\n    cropBox.addEventListener('mousedown', startMoveCropBox);\r\n    cropBox.addEventListener('mouseup', stopMoveCropBox);\r\n\r\n    const cropBoxControl = document.querySelector('.crop-box-control');\r\n    cropBoxControl.addEventListener('mousedown', startChangeCropBox);\r\n    cropBoxControl.addEventListener('mouseup', stopChangeCropBox);\r\n\r\n    const cropButton = document.querySelector('.crop-btn');\r\n    cropButton.addEventListener('click', crop);\r\n}\r\n\r\nfunction startMoveCropBox(e) {\r\n    const cropBoxStyles = cropBox.getBoundingClientRect();\r\n    shiftCoefficient = {\r\n        x: e.pageX - cropBoxStyles.left,\r\n        y: e.pageY - cropBoxStyles.top\r\n    }\r\n    body.addEventListener('mousemove', moveCropBox);\r\n    body.addEventListener('mouseup', stopMoveCropBox);\r\n}\r\n\r\nfunction moveCropBox(e) {\r\n    const cropBoxStyles = cropBox.getBoundingClientRect();\r\n\r\n    cropBox.style.left = e.pageX - shiftCoefficient.x + 'px';\r\n    cropBox.style.top = e.pageY - shiftCoefficient.y + 'px';\r\n}\r\n\r\nfunction stopMoveCropBox() {\r\n    body.removeEventListener('mousemove', moveCropBox);\r\n}\r\n\r\n\r\nfunction startChangeCropBox(e) {\r\n    e.stopPropagation();\r\n    body.addEventListener('mousemove', changeCropBox);\r\n    body.addEventListener('mouseup', stopChangeCropBox);\r\n}\r\n\r\nfunction changeCropBox(e) {\r\n    const cropBoxStyles = cropBox.getBoundingClientRect();\r\n\r\n    cropBox.style.width = e.pageX - cropBoxStyles.left + 'px';\r\n    cropBox.style.height = e.pageY - cropBoxStyles.top + 'px';\r\n}\r\n\r\nfunction stopChangeCropBox() {\r\n    body.removeEventListener('mousemove', changeCropBox);\r\n}\r\n\r\nfunction crop() {\r\n    const myCanvas = document.querySelector('.my-canvas');\r\n    const cropBoxStyles = cropBox.getBoundingClientRect();\r\n    const imageWrapperStyles = imageWrapper.getBoundingClientRect();\r\n\r\n    myCanvas.setAttribute('width', cropBoxStyles.width + 'px');\r\n    myCanvas.setAttribute('height', cropBoxStyles.height + 'px');\r\n\r\n    const ctx = myCanvas.getContext('2d');\r\n    const img = document.querySelector('.preview');\r\n    ctx.drawImage(img, -(cropBoxStyles.left - imageWrapperStyles.left), -(cropBoxStyles.top - imageWrapperStyles.top));\r\n}"]}